"use strict";(self.webpackChunkselubi_tech=self.webpackChunkselubi_tech||[]).push([[565],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),u=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=u(e.components);return i.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},f=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=u(n),f=o,h=c["".concat(s,".").concat(f)]||c[f]||d[f]||r;return n?i.createElement(h,a(a({ref:t},p),{},{components:n})):i.createElement(h,a({ref:t},p))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=f;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:o,a[1]=l;for(var u=2;u<r;u++)a[u]=n[u];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}f.displayName="MDXCreateElement"},8436:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>u});var i=n(7462),o=(n(7294),n(3905));const r={id:"linux-boot-grub",title:"GRUB Bootloader",sidebar_label:"GRUB Bootloader",sidebar_position:2,tags:["Linux"]},a=void 0,l={unversionedId:"linux/boot/linux-boot-grub",id:"linux/boot/linux-boot-grub",title:"GRUB Bootloader",description:"One of the main sources of this article is the LPIC-1 Exam 101 Learning Material: 102.2.",source:"@site/docs/linux/boot/grub.md",sourceDirName:"linux/boot",slug:"/linux/boot/linux-boot-grub",permalink:"/linux/boot/linux-boot-grub",draft:!1,editUrl:"https://github.com/Selubi/selubi.github.io/tree/main/docs/linux/boot/grub.md",tags:[{label:"Linux",permalink:"/tags/linux"}],version:"current",sidebarPosition:2,frontMatter:{id:"linux-boot-grub",title:"GRUB Bootloader",sidebar_label:"GRUB Bootloader",sidebar_position:2,tags:["Linux"]},sidebar:"defaultSidebar",previous:{title:"BIOS and UEFI",permalink:"/linux/boot/linux-boot-bios"},next:{title:"Setup",permalink:"/category/setup"}},s={},u=[{value:"What is it?",id:"what-is-it",level:2},{value:"Configuring GRUB",id:"configuring-grub",level:2},{value:"Location of GRUB and its config files",id:"location-of-grub-and-its-config-files",level:3},{value:"Configuring <code>grub.cfg</code>",id:"configuring-grubcfg",level:3},{value:"Extra Notes",id:"extra-notes",level:2}],p={toc:u},c="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"One of the main sources of this article is the ",(0,o.kt)("a",{parentName:"p",href:"https://learning.lpi.org/en/learning-materials/learning-materials/"},"LPIC-1 Exam 101 Learning Material: 102.2"),".\nHowever, particularly for this topic, plenty of scattered information across the internet is used as the source."),(0,o.kt)("h2",{id:"what-is-it"},"What is it?"),(0,o.kt)("p",null,"A bootloader is the first software that runs after the computer is powered on. It is executed by the system firmware (UEFI/BIOS), whose main responsibility is to identify and load the operating system kernel and pass control to it. When you install a Linux distribution, it usually comes with a bootloader called ",(0,o.kt)("a",{parentName:"p",href:"https://www.gnu.org/software/grub/"},"GRUB (GRand Unified Bootloader)"),"."),(0,o.kt)("p",null,"When we refer to GRUB, usually, we are referring to GRUB 2, which replaced the original GRUB (now called GRUB Legacy)."),(0,o.kt)("p",null,"In UEFI systems, GRUB is installed in an ESP (EFI System Partition) as an EFI Application. If the system has multiple GRUB, which may happen when you install multiple OSes, it will show as separate entries in the UEFI bootloader configuration."),(0,o.kt)("p",null,"In BIOS systems, GRUB is installed in the MBR (Master Boot Record). ",(0,o.kt)("a",{parentName:"p",href:"/linux/boot/linux-boot-bios#bios-difference-to-uefi"},"BIOS only executes the MBR of the first disk"),", so other MBRs (in different disks) are ignored even if it exists."),(0,o.kt)("p",null,"A single GRUB can handle the boot of multiple operating systems when configured properly."),(0,o.kt)("h2",{id:"configuring-grub"},"Configuring GRUB"),(0,o.kt)("h3",{id:"location-of-grub-and-its-config-files"},"Location of GRUB and its config files"),(0,o.kt)("p",null,"In UEFI based system, GRUB is loaded from the file ",(0,o.kt)("inlineCode",{parentName:"p"},"grubx64.efi")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"grubia32.efi")," for 64-bit and 32-bit systems, respectively, from the ESP. Linux distributions often mount the contents of the ESP at ",(0,o.kt)("inlineCode",{parentName:"p"},"/boot/efi")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"/efi")," (the exact location depends on the distribution)."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"After you reach the Operating System, ",(0,o.kt)("inlineCode",{parentName:"p"},"/boot/efi")," does not impact the current session. The purpose of mounting it is to configure it for the sessions after.")),(0,o.kt)("p",null,"The location of the GRUB config file is a topic that is confusing to find a definite answer on. First, GRUB reads the configuration from a file called ",(0,o.kt)("inlineCode",{parentName:"p"},"grub.cfg"),"."),(0,o.kt)("p",null,"In BIOS based machine, the ",(0,o.kt)("inlineCode",{parentName:"p"},"grub.cfg")," is located on ",(0,o.kt)("inlineCode",{parentName:"p"},"/boot/grub"),". Here, GRUB (located in MBR) is configured to look for the config files in the pre-specified partition. A reminder that ",(0,o.kt)("a",{parentName:"p",href:"https://superuser.com/questions/368173/what-is-the-maximum-number-of-partitions-that-can-be-made-on-a-hard-drive"},"BIOS and UEFI partition works differently"),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"grub.cfg")," may be stored in ESP with GRUB itself in UEFI systems, but this is not always true. In many cases, to maintain compatibility with BIOS, it is located in ",(0,o.kt)("inlineCode",{parentName:"p"},"/boot/grub"),", which is the mount location of the boot partition. If there is no boot partition, ",(0,o.kt)("inlineCode",{parentName:"p"},"/boot/grub")," (and consequently ",(0,o.kt)("inlineCode",{parentName:"p"},"grub.cfg"),") is located on the root partition."),(0,o.kt)("p",null,"RHEL (Red Hat Enterprise Linux) used to put ",(0,o.kt)("inlineCode",{parentName:"p"},"grub.cfg")," in the ESP for UEFI based machine and ",(0,o.kt)("inlineCode",{parentName:"p"},"/boot/grub")," on others, but ",(0,o.kt)("a",{parentName:"p",href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html-single/9.0_release_notes/index#enhancement_boot-loader"},"RHEL 9 changes this location to ",(0,o.kt)("inlineCode",{parentName:"a"},"/boot/grub")," uniformly"),"."),(0,o.kt)("p",null,"GRUB checks the ",(0,o.kt)("a",{parentName:"p",href:"https://www.gnu.org/software/grub/manual/grub/html_node/prefix.html"},(0,o.kt)("inlineCode",{parentName:"a"},"$prefix")," variable")," for the ",(0,o.kt)("inlineCode",{parentName:"p"},"grub.cfg")," location. This is set during the installation of GRUB."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"The ",(0,o.kt)("inlineCode",{parentName:"p"},"$prefix")," variable is for the GRUB command line, not the Linux one.")),(0,o.kt)("h3",{id:"configuring-grubcfg"},"Configuring ",(0,o.kt)("inlineCode",{parentName:"h3"},"grub.cfg")),(0,o.kt)("p",null,"TODO"),(0,o.kt)("h2",{id:"extra-notes"},"Extra Notes"),(0,o.kt)("p",null,"The information regarding bootloaders is all over the place. For example, below are some questions that might get different answers."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If we install GRUB via RHEL installation and Ubuntu after that, will Ubuntu's installation wizard GRUB create a different ESP or modify the existing one?"),(0,o.kt)("li",{parentName:"ul"},"Where is the exact location of ",(0,o.kt)("inlineCode",{parentName:"li"},"grub.cfg")," for ",(0,o.kt)("inlineCode",{parentName:"li"},"X")," distro?"),(0,o.kt)("li",{parentName:"ul"},"What are the exact contents of the ",(0,o.kt)("inlineCode",{parentName:"li"},"ESP"),"?"),(0,o.kt)("li",{parentName:"ul"},"How does the Windows bootloader play with GRUB?")),(0,o.kt)("p",null,"To get definite answers to these, we need to do experimentation. Always do a backup before messing with GRUB, as a wrong configuration can easily break things."),(0,o.kt)("p",null,"Last updated: July 7, 2023"))}d.isMDXComponent=!0}}]);